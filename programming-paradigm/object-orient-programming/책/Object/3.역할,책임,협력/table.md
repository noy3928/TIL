# 역할, 책임, 협력

- 객체지향 패러다임 관점에서 핵심은 역할, 책임, 협력이다.
- 객체지향의 본질은 협력하는 객체들의 공동체를 창조하는 것이다.
- 역할, 책임, 협력이 제자리를 찾지 못한 상태라면 응집도 높은 클래스와 중복 없는 상속 계층을 구현한다고 해도 어플은 침몰할 것이다.

# 01 협력

## 영화 예매 시스템 돌아보기

- 어플의 제어 흐름은 객체들 사이에 균형있게 분배되는 것이 일반적이다.
- 핵심은 객체들이 메시지를 주고 받으며 상호작용한다는 것이다.
- 이런 상호작용을 협력이라고 한다.
- 협력에 참여하기 위해 수행하는 로직은 책임이다.
- 책임들이 모여 역할을 구상한다.(? 이부분은 아직 이해가 안된다.)

<br>

요약 : 영화 예매 시스템 속에서 발견할 수 있었던 협력이 무엇인지 소개한다. 협력은 객체들 사이에 메시지를 주고받는 상호작용을 말한다.

## 협력

- 객체지향의 세계에선 협력을 통해 기능을 구현한다.
- 메시지 전송은 객체 사이의 협력을 위해 사용할 수 있는 유일한 커뮤니케이션 수단이다.

> 협력이란 어떤 객체가 다른 객체에게 무엇인가를 요청하는 것이다. 한 객체는 어떤 것이 필요할 때 다른 객체에게 전적으로 위임하거나 서로 협력한다. 즉, 두 객체가 상호작용을 통해 더 큰 책임을 수행하는 것이다. 객체 사이의 협력을 설계할 때는 객체를 서로 분리된 인스턴스가 아닌 협력하는 파트너로 인식해야 한다.

- 메시지를 수신한 객체는 메서드를 통해 요청에 응답한다.
  - 메시지를 처리할 방법은 객체가 스스로 선택한다.
  - 외부객체는 메시지만 전송할 뿐 수신한 객체가 처리하는 방법은 모른다.
- 객체를 자율적으로 만드는 가장 기본적인 방법은 캡슐화다.

<br>

요약 : 객체지향에서 협력의 의미가 무엇인지 살펴본다. 협력은 객체들 사이의 상호작용이다. 객체들은 메시지를 통해서 상호작용을 하며, 메시지를 수신한 객체는 그것을 어떻게 처리할 지 자율적으로 선택한다. 메시지를 보내는 당사자는 수신자가 그것을 어떻게 처리할지 모르는데, 이것이 잘 수행되어있는 것을 캡슐화가 잘 되었다고 할 수 있다. 이런 캡슐화를 통해 객체는 외부의 간섭을 받지 않는 자율적인 존재가 된다.

## 협력이 설계를 위한 문맥을 결정한다

- 객체 : 상태와 행동을 함께 캡슐화하는 실행 단위
  - 객체의 상태와 행동을 어떤 기준으로 정해야할까?
- 객체는 섬이 아니다.
  - 객체가 필요한 단 하나의 이유 : 그 객체가 어떤 협력에 참여하고 있기 때문이다.
  - 객체가 협력에 참여할 수 있는 이유 : 협력에 필요한 적절한 행동을 보유하고 있기 떄문
- 객체의 행동을 결정하는 것 : 객체가 참여하고 있는 협력
  - 협력이 바뀌면 객체의 행동도 바뀐다.
- 객체의 상태를 결정하는 것 : 객체의 행동
  - 객체의 상태는 그 객체가 행동을 수행하는 데 필요한 정보가 무엇인지로 결정된다.
- 협력은 객체를 설계하는데 필요한 문맥을 제공한다.
  - 상태는 객체가 행동하는 필요한 정보에 의해 결정되고
  - 행동은 협력 안에서 객체가 처리할 메시지로 결정되기 때문이다.

<br>

요약 : 객체는 결국 문맥에 의해서 결정된다. 협력의 문맥속에서 객체의 행동이 결정되고, 그 행동이 객체의 상태를 결정짓는다. 협력의 문맥을 고려해야만 결국 객체를 정의내릴 수 있다.

# 02 책임

## 책임이란 무엇인가

- 협력에 참여하기 위해 객체가 수행하는 행동을 책임이라고 부른다.
- 객체의 책임은 크게 하는 것과 아는 것으로 나누어져있다.
  - 하는 것
    - 객체를 생성하거나 계산을 수행하는 등의 스스로 하는 것
    - 다른 객체의 행동을 시작하는 것
    - 다른 객체의 활동을 제어하고 조절하는 것
  - 아는 것
    - 사적인 정보에 관해 아는 것
    - 관련된 객체에 관해 아는 것
    - 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것
- 책임과 메시지는 다르다. 크기부터 다르다.
  - 책임은 객체가 수행할 수 있는 행동을 종합적이고 간략하게 서술했기 때문에 메시지보다 추상적이고 개념적으로도 크다.
  - 단순한 책임이라고 생각했던 것이 여러개의 메시지로 분할되기도 한다.
- 아는 것과 하는 것은 밀접하게 연관되어 있다.
  - 객체는 자신이 맡은 책임을 수행하는 데 필요한 정보를 알고 있을 책임이 있다.
  - 자신이 수행할 수 없는 일을 도와 줄 객체를 알고있을 책임이 있다.
- 객체지향의 핵심 : 책임
  - 크레이그 라만 => "객체지향 개발에서 가장 중요한 능력은 책임을 능숙하게 소프트웨어 객체에 할당하는 것"
  - 협력이 중요한 이유도 결국 객체에게 적절한 책임을 부여할 문맥을 제공하기 때문이다.
  - 객체에게 얼마나 적절한 책임을 할당하느냐가 설계의 전체적인 품질을 결정한다.

<br>

요약 : 객체지향의 핵심이 되는 책임이 무엇인지에 대해서 설명하고 있다.

## 책임 할당

- 책임을 수행하는 데 필요한 정보를 가장 잘 알고 있는 전문가에게 그 책임을 할당하는 것이다.
  - 이것를 정보전달 패턴이라고 한다. INFORMATION EXPERT
- 다른 객체에게 책임을 할당하기 위해서 필요한 것 : 협력이라는 문맥
  - 이 문맥이 정의되어 있어야 다른 객체에게 책임을 할당할 수 있다.
- 협력을 설계하는 출발점
  - 시스템이 사용자에게 제공하는 기능을 시스템이 담당할 하나의 책임으로 바라보는 것
  - 시스템의 책임을 완료하는 데 필요한 더 작은 책임을 찾아내고 이를 객체들에게 할당하는 반복적인 과정을 통해 모양을 갖춘다.
- 책임을 할당하는 과정
  - 예매하라
    - 예매하는 책임을 누구에게 할당할까?
    - 영화 예매와 관련된 정보를 가장 많이 알고 있는 객체에게 책임을 할당하자.
    - Screening이 가장 많이 알고있는 것 같다.
  - Screening : 가격을 계산하라
    - screening은 예매 가격을 계산하는데 필요한 정보를 충분히 알고 있지 못하다.
    - 때문에 가격 계산을 위한 전문가에게 이 일을 맞겨야 한다.
    - Movie가 영화 가격에 대한 가장 많은 정보를 알고 있는 것 같다.
  - Movie : 할인 요금을 적용하라
    - 그런데 Movie는 할인 요금과 관련된 정보를 알고 있지 못하다.
    - 또 이 일을 부여할 책임자를 찾아야할 것 같다.
- 이처럼 책임을 할당하는 과정은 적절한 객체를 찾고 할당하는 과정을 거친다.
  <br>

요약 : 책임 할당의 의의에 대해서 설명하고 있으며, 그것이 어떻게 이루어지는지를 설명하는 파트였다.

## 책임 주도 설계

- 책임주도설계 :
  - 책임을 찾고 책임을 수행할 적절한 객체를 찾아 책임을 할당하는 방식으로 협력을 설계하는 방법을 책임주도설계라고 한다.
- 책임주도설계의 과정
  - 시스템이 사용자에게 제공해야하는 기능인 시스템 책임을 파악한다.
  - 시스템 책임을 더 작은 책임으로 분할한다.
  - 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.
  - 객체가 책임을 수행하는 도중 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾는다.
  - 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 한다.
- 책임을 할당할 때, 고려해야 할 2가지 요소
  1. 메시지가 객체를 결정한다.
  2. 행동이 상태를 결정한다.

<br>

요약 : 앞에서 이야기했던 내용들을 정리하면서, 책임주도설계가 무엇인지를 설명한다.

## 메시지가 객체를 결정한다

- 메시지를 먼저 식별했다.
  - 메시지를 처리할 객체를 나중에 선택했다는 사실이 중요하다.
  - 다시말해 객체가 메시지를 선택하는 것이 아니라, 메시지가 객체를 선택한다는 것이다.
- 메시지가 객체를 선택해야하는 2가지 이유 :
  1. 객체가 최소한의 인터페이스를 가질 수 있게 한다.
     - 객체는 어플에 크지도, 작지도 않은 꼭 필요한 크기의 퍼블릭 인터페이스를 가질 수 있다.
  2. 객체는 충분히 추상적인 인터페이스를 가질 수 있다.
     - 메시지를 먼저 식별하면 무엇을 수행할지에 초점을 맞추는 인터페이스를 얻을 수 있다.
     - 어떻게는 감출 수 있다.
- 메시지를 먼저 식별함으로써 객체의 책임을 할당한 결과
  - 객체들의 인터페이스는 충분히 추상적인 동시에 최소한의 크기를 유지할 수 있었다.

<br>

요약 : 책임을 할당할 때, 고려해야할 첫번째 요소로 메시지를 먼저 식별하는 것의 중요성에 대한 이야기를 하고 있었다. 메시지를 먼저 식별해야만, 적절한 인터페이스를 가지게 할 수 있다.

## 행동이 상태를 결정한다

- 객체를 객체답게 만드는 것 : 행동
- 객체가 협력에 참여하는 방법 : 행동
  - 협력에 적합한지를 판단하는 기준은 객체의 상태가 아니라 행동이다.
- OOP에 처음입문한 사람들이 하는 실수
  - 행동보다 상태에 초점을 맞추는 것
  - 이런 방식은 캡슐화를 저해한다.
  - 이렇게 상태에 초점을 맞춰서 구현하는 방법을 데이터 주도 설계라고 한다.
- 항상 협력이라는 문맥속에서 객체를 생각해야한다.
  - 그래야 캡슐화를 위반하지 않도록 구현에 대한 결정을 뒤로 미룰 수 있다.
    - 아 상태에 먼저 집중하면 구현에 대한 결정을 먼저 생각하게 되겠구나.
- 중요한 것은 객체의 상태가 아닌 행동이다.

<br>

요약 : 책임을 할당하려 할 때, 주의해야할 2번째 요소를 설명하고 있었다. 객체를 설계할 때는 행동을 먼저 생각해야한다. 행동을 결정한 다음에 상태가 결정된다. 이렇게 해야만 객체지향적인 설계를 할 수 있다.

# 03 역할

- 역할의 정의 :
  - 객체가 어떤 특정한 협력 안에서 수행하는 책임의 집합을 역할이라고 부른다.
  - 실제로 협력을 모델링 할 때는 특정한 객체가 아닌 역할에게 책임을 할당한다고 생각하는 것이 좋다.
- 책임 할당 과정에서의 역할
  1. 영화를 예매할 수 있는 적절한 역할이 무엇인가 찾는다.
  2. 역할을 수행할 객체로 Screening 인스턴스를 선택한다.

<br>

요약 : 역할을 정의내리고, 이것을 고려하는 것이 설계과정에서 왜 필요한 것인지 서두를 열고 있다.

## 역할과 협력

- 역할이 중요한 이유 :
  - 역할을 통해 유연하고 재사용 가능한 협력을 얻을 수 있기 때문이다.
- 동일한 책임을 가지고 있는 객체들의 책임을 역할로 추상화시킬 수 있다.

## 유연하고 재사용 가능한 협력

> 역할은 다른 것으로 교체할 수 있는 책임의 집합이다.

- 추상화
  - 역할이 두 종류의 객체를 포괄하는 추상화라는 점을 주목하기.
  - amountDiscountPolicy와 percentDiscountPolicy를 포괄할 수 있는 추상적인 이름은 DiscountPolicy다.
- 요점
  - 동일한 책임을 수행하는 역할을 기반으로 두 개의 협력을 하나로 통합할 수 있다는 것.
  - 역할을 이용하면 불필요한 중복코드를 제거할 수 있다.

나의 질문 : 앞 장에서 이야기했던 동일한 인터페이스. 동일한 메시지.를 하나의 역할로 볼 수 있는 것일까?

## 객체 대 역할

- 역할은 객체가 참여할 수 있는 일종의 슬롯이다.
  - 유용하고 재사용 가능한 설계라는 문맥에서 역할의 중요성은 아무리 강조해도 지나치지 않다.

> 레베카 워프스브록
>
> > 객체에 관해 생각할 때 '이 객체가 무슨 역할을 수행해야 하는가?' 라고 자문하는 것이 도움이 된다. 이 질문은 객체가 어떤 형태를 띠어야 하는지, 그리고 어떤 동작를 해야 하는지에 집중할 수 있게 도와준다. 지금까지 객체와 역할에 대해 막연하게 이야기를 했는데, 둘의 진짜 차이는 무엇일까? 만약 동일한 종류의 객체가 하나의 역할을 항상 수행한다면 둘은 동일한 것이다. 하지만 어떤 협력에서 하나 이상의 객체가 동일한 책임을 수행할 수 있다면 역할은 서로 다른 방법으로 실행할 수 있는 책임의 집합이 된다. 역할이란 프로그램이 실행될 때 소프트웨어 기계 장치에서 적절한 객체로 메워 넣을 수 있는 하나의 슬롯으로 생각할 수 있다. ---배우가 극중에서 믿을 수 있는 배역을 맡아서 하려는 것처럼 객체는 의미 있는 역할을 정의하는 책임을 통해 애플리케이션의 기능을 담당하게 된다.

- 협력에 적합한 책임을 수행하는 대상이 한 종류라면 간단하게 객체로 간주한다.
  - 만약 여러 종류의 객체들이 참여할 수 있다면 역할이라고 한다.
- 트리그비 린스카우

  - 역할을 가리켜 실행되는 동안 협력 안에서 각자의 위치를 가지는 객체들에 대한 별칭이라고 정의하기도 함
  - 협력은 역할들의 상호작용으로 구성된다. 그리고 협력을 구성하기 위해 역할에 적합한 객체가 선택된다.

- 불명확성
  - 대부분의 경우 어떤 것이 역할이고 어떤 것이 객체인지 또렷하게 드러나지 않을 것이다.
- 설계 초반
  - 적절한 책임과 협력의 큰 그림을 탐색하는 것이 가장 중요하다.
  - 역할과 객체를 명확하게 구분하는 것은 그렇게 중요하지 않다.
  - 따라서 단순하게 객체로 시작하고 반복적으로 책임과 협력을 정제해가면서 필요한 순간에 객체로부터 역할을 분리해내는 것이 가장 좋은 방법이다.
- 역할로 시작해야 할 때 :
  - 다양한 객체들이 협력에 참여한다는 것이 확실하다면 그렇게 시작한다.
- 역할의 가장 큰 장점 :
  - 설계의 구성 요소를 추상화할 수 있다.

<br>

요약 : 설계 초반에는 역할을 정의하는 것이 애매할 수도 있다. 그러면 객체로부터 시작해라! 그리고 역할을 정의할 수 있는 순간이 되면 역할을 정의해라. 역할을 정의하는 것은 설계적 유연성의 측면에서 유용하다.

## 역할과 추상화

- 추상화의 2가지 장점 :

  1. 추상화 계층만을 이용하면 중요한 정책을 상위 수준에서 단순화할 수 있다.
  2. 설계가 좀 더 유연해진다.

- 추상화의 장점은 역할에도 동일하게 적용될 수 있다.
  - 객체들의 협력관계를 추상화해서 표현할 수 있다.
- 역할이 중요한 이유 :
  - 동일한 협력을 수행하는 객체들을 추상화할 수 있기 때문이다.
- 프레임워크나 디자인 패턴과 같이 재사용 가능한 코드나 설계 아이디어를 구성하는 핵심적인 요소가 역할이다.

<br>

요약 : 추상화의 관점에서 역할이 왜 중요한지에 대해서 설명하고있다.

## 배우와 배역

- 연극에 참여하는 순간 배역만 남고 배우는 사라진다.
- 배역과 배우간의 관계
  - 배역은 연극 배우가 특정 연극에서 연기하는 역할이다.
  - 배역은 연극이 상영되는 동안에만 존재하는 일시적인 개념이다.
  - 연극이 끝나면 연극 배우는 배역이라는 역할을 벗어 버리고 원래의 연극 배우로 돌아온다.
  - 서로 다른 배우들이 동일한 배역을 연기할 수 있다.
  - 하나의 배우가 다양한 연극 안에서 서로 다른 배역을 연기할 수 있다.
- 배역을 연기하는 배우라는 은유
  - 협력안에서 역할을 수행하는 객체라는 관점을 훌륭하게 담아내는 은유
  - 협력은 연극과 동일하고 코드는 극본과 동일하다.
  - 객체는 협력이라는 실행 문맥 안에서 특정한 역할을 수행한다.
  - 객체는 협력이 끝나면 협력에서의 역할을 잊고 원래의 객체로 돌아온다.
- 역할은 객체의 페르소나다
  - 역할은 객체가 협력에 참여하는 잠시 동안에만 존재하는 일시적인 개념이다.
  - 역할은 모양이나 구조에 의해 정의될 수 없으며 오직 시스템의 문맥 안에서 무엇을 하는지에 의해서만 정의될 수 있다.
