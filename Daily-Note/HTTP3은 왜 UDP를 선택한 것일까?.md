### 날짜 : 2022-11-18 18:06
### 주제 : #네트워크 #HTTP3 

---- 

### 메모 : 
- HTTP 작업 그룹의 의장 마크 노팅엄 

- TCP의 신뢰성 : 
	- 전송되는 데이터 패킷들의 순서, 패킷 유실 여부 
	- 송신 측이 보낸 데이터가 수신 측에 온전하게 전달될 수 있느냐 
- 그런데 이렇게 신뢰성을 보장하는 방식으로 수행하다보면, 레이턴시가 생길 수 밖에 없었다. 
	- 레이턴시를 줄일 수 있겠지만, 이런 방법을 도입하는 것은 너무 많은 영역을 뜯어고쳐야하고, 또 그 업데이트에 따라서 개인 컴퓨터 이용자들이 os를 업데이트해주어야하는데, 그것 또한 많은 제한이 따른다. 

- 이 글에서는 TCP의 문제점을 2가지로 설명하고 있다. 
	- 3-way-handshake때문에 연결 수립 속도가 느리다 
	- HOLB 가 있다. 

- UDP
	- 애초에 각각의 패킷 간의 순서가 존재하지 않는 독립적인 패킷을 사용한다. 
	- 목적지만 정해져 있으면 중간 경로는 어딜 타든 신경쓰지 않는다. 종단 간 연결 설정 또한 하지 않는다. 
	- 결론적으로 UDP가 신뢰성을 확보하기 위해서 하던 많은 작업들을 하지 않는다. 
		- 그래서 더 빠르다. 

- UDP를 사용하면서 뭐가 더 좋아진걸까? 
	- HTTP + TCP + TLS를 사용했던 방법보다 더 좋아졌다. 
	- 연결 설정 시 레이턴시 감소 
		- TCP는 기본 1RTT + TLS를 이용한 암호화까지 하면 + 2RTT가 필요하다 => 3 RTT 
		- QUIC은 1RTT만 소요된다. 
			- 첫번째 핸드쉐이크 때, 연결 설정에 필요한 정보와 함께 데이터도 다 보낸다. 
			- TCP + TLS는 데이터를 보내기 전에 신뢰성있는 연결과 암호화에 필요한 모든 정보를 교환하고 유효성을 검사한 뒤에 데이터를 교환한다. 
			- QUIC은 냅다 데이터부터 꽂아버린다. 
			- 클라이언트가 첫 요청을 보낼 때는 서버의 세션키를 모른다. 때문에 목적지 서버의 Connection Id를 사용하여 생성한 Initial Key를 사용해서 통신을 암호화한다. 
				- 한번 연결에 성공했으면 서버는 그 설정을 캐싱한다. 때문에 다음부터는 0 RTT가 가능해진다. 


- TCP가 사용하는 손실감지 방법 
	- Stop and Wait ARQ 
	- 송신 측이 패킷을 보낸 후 타이머를 사용하여 시간을 재고, 일정 시간이 경과해도 수신 측이 적절한 답변을 주지 않는다면 패킷이 손실된 것으로 판단. 
		- 이때 기다리는 시간은 어떻게 계산하는가? 이 시간은 동적으로 계산된다. 
		- 한번 패킷을 보낸 후 잘 받았다는 응답을 받을 때 걸렸던 시간들을 측정해서 동적으로 타임 아웃을 설정한다. 
- QUIC이 패킷 손실을 감지하는 방법 
	- 헤더에 별도의 패킷 번호 공간을 부여 
	- 이 번호는 전송 순서 자체만을 나타낸다. 
		- 재전송시 동일한 번호가 전송되는 시퀀스 번호와는 다르다. 
		- 매 전송마다 모노토닉하게 패킷 번호가 증가한다. 
			- 때문에 패킷의 전송 순서를 명확하게 파악할 수 있다. 
			- 모노토닉하다는게 무슨 말일까?
				- 양적관계가 분명한 방식으로 증가한다?? 
	- 패킷 번호를 부여한다?? 


- 멀티플렉싱 
	- 이 자료에서는 HTTP3에서 어떻게 멀티플렉싱을 지원하는지 상세하게 설명하지 않는다. 

- 연결유지 
	- TCP의 경우 소스의 IP 주소와 포트 그리고 연결대상의 IP 주소와 포트로 연결을 식별한다. 때문에 클라이언트의 IP가 바뀌는 상황이 생기면 연결이 끊긴다. 
		- 연결이 끊기면 다시 3번의 악수를 진행해야한다. 
		- 이 과정에서 레이턴시가 발생한다. 
		- 요즘에는 WI-fi에서 셀룰러로 전환되거나, 그 반대경우가 많이 일어나기 때문에 여기서의 속도 저하 문제가 눈에 띄게 된다. 
	- 하지만 QUIC는 Connection ID를 사용하여 서버와의 연결을 생성한다. 
		- Connection ID는 랜덤한 값이다. 
			- 클라이언트 IP와는 무관한 데이터다. 
			- 클라이언트 IP가 변경되어도 기존의 연결을 계속 유지할 수 있다. 


### 내 생각과 정리 : 
- UDP가 속도가 더 빠른 측면
	- 연결수립 
	- 손실감지 
		- 근데 이 자료만 읽어서는 아직 손실감지를 UDP가 어떻게하는지 이해 못한 것 같다. 
	- 멀티플렉싱 
	- 연결유지 



- 그런데 이 자료에서도 아직 자세하게 설명하지 않은 부분들이 있는 것 같다. 아직 나의 갈증이 해결되지 않은 부분이란 
	- 손실감지하는 방법이 달라졌다고 했는데, 구체적으로 그것이 어떻게 이루어졌는지를 알 수가 없다. 
	- HTTP3에서의 멀티플렉싱은 어떻게 이루어지는지? 왜 HTTP3에서의 멀티플렉싱은 HOLB 문제를 해결하는지? 
	- Connection ID를 가지고 연결을 지속할 수 있다고 했는데, 그것이 구체적으로 어떤 과정을 거쳐서 이루어지는 것인지 알 수가 없어서 아쉬운 것 같다. 

- 나는 현재 글을 쓸 목적으로 자료를 읽고 모으고 있기 때문에 해당 내용들을 이해하지 못하면, 나만의 언어로 글을 풀어낼 수가 없을 것 같다. 
	- 그래도 이 글을 통해서는 HTTP3에 대해서 어떤 개요로 글을 써야할지 파악할 수 있었던 것 같다. 
		- 그리고 앞으로 어떤 자료를 더 찾아봐야할 지도 알 수 있었다. 




### 출처(참고문헌) : 
[HTTP3는 왜 UDP를 선택했을까](https://evan-moon.github.io/2019/10/08/what-is-http3/)


### Link : 
