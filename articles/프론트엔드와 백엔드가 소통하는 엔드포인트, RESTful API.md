> https://evan-moon.github.io/2020/04/07/about-restful-api/#rest%EA%B0%80-%EC%9D%98%EB%AF%B8%ED%95%98%EB%8A%94-%EA%B2%83%EC%9D%B4-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80%EC%9A%94


## 나의 정리 : 


### REST api는 리소스에 대한 '표현'

리소스와 리소스의 '표현'을 구분하여 생각해야한다. rest api는 리소스 그 자체를 나타내는 것이 아니다. 리소스에 대한 표현이다. 때문에, 리소스를 어떻게 표현할 것인지를 고민해야한다.

(어떻게 잘 표현할 것인가는 아직 나에겐 물음표의 영역이다. 하지만, `리소스 그 자체를 나타내는 것이 아님` 을  인지하는 것 만으로도 api 설계에 도움을 받을 수 있을 것 같다.)



### URI 명명 규칙

- URI에는 오로지 리소스의 상태만 나타내야한다. 
- 행위는 HTTP 메소드로 표현한다.
- 리소스를 표현할 때는 무조건 복수로 표현한다. 왜냐하면 특정한 하나의 리소스를 명시하는 것이 아닌, '개념'을 명시하는 것이기 때문.



### PATCH와 멱등성

멱등성이란 여러번 시도해도 항상 같은 결과를 보장함을 의미한다. 하지만, patch 메서드는 멱등한 메서드가 아니다. 그 말인즉, 동일한 요청에 다른 결과를 받을 수 있다는 말이다.

PUT의 경우에는 요청받은 바디를 가지고 그대로 리소스와 교체한다. 때문에 멱등하다. 그러나, PATCH의 경우 요청받은 바디의 설명(`description of changes`)을 따라 리소스에 사이드 이펙트를 가한다. 


### 좋은 API란? 

어느 누가 맥락없이 봐도, 어떤 동작을 하는 API인지 이해할 수 있는 API


---

## 노트 

- 리소스와 리소스의 표현을 구분해서 생각할 것. rest api라는 것은 리소스 그 자체를 나타내는 것이 아니다. 리소스에 대한 표현을 나타내는 것.


- REST가 말하는 것은 단지 리소스의 '상태'를 나타내는 것이다. REST에서는 api의 '행위'를 표현하지 않는다.
- '행위'를 나타내는 것은 메서드(GET, POST, PUT, DELETE)이다.



> 리소스가 어떻게 표현되는지? - REST
> 어떤 리소스인지? - URI
> 어떤 행위인지? - HTTP 메소드

- 
- URI
  - 리소스를 표현할 때, 복수를 사용하는 이유는 특정한 대상 하나라를 나타내는 것이 아니라, '개념'을 나타내는 것이기 때문이다.
  - 특정 대상을 가져오고 싶을 때는, 복수 다음에 오는 문자열을 통해 특정 대상을 가져오는 것이다. `users/1` 이런식이다.
    - 2가지 api의 의미차이 :
      - `/users/2/profile-image` : 유저들 중 2번 유저의 프로필 사진
      - `/profile-images/users/2` : 프로필 사진들 중 2번 유저의 프로필 사진
  - URI에는 행위가 표현되면 안된다.
	  - URI가 가지는 의미는 철저히 어떤 리소스인지, 그리고 리소스의 계층 구조에 대한 것 뿐이어야한다.


- PUT과 PATCH의 차이
	- PUT : 리소스를 수정하는 것이 아니라 리소스를 요청 바디에 담긴 것으로 대체하는 것
		- 반드시 요청 바디에 리소스 전체를 표현해야한다. 수정할 사항만 보내는 것이 아닌, 수정하지 않을 사항까지 모두 함께 표현해야한다.
	- 멱등성 : PUT은 멱등성을 보장하지만, PATCH는 멱등성을 보장하지 않을 수도 있다.


- 메소드가 멱등성을 보장하는가?
	- 멱등성 : 수학이나 전산학에서 어떤 대상에 같은 연산을 여러 번 적용해도 결과가 달라지지 않는 성질을 이야기한다.
	- 멱등성 보장
		- GET -> O
		- PUT -> O
		- DELETE -> O
		- POST -> X
		- PATCH -> X


- PATCH가 멱등성을 보장하지 않는 이유
	- https://datatracker.ietf.org/doc/html/rfc5789
		- 이 문서에 의하면 PATCH 요청의 바디에는 `description of changes` 라는 설명만 존재한다.
```http
PATCH users/1
{
  $increase: 'age',
  value: 1,
}
```
이런 방식으로 변경에 대한 묘사를 통해서 요청하는 것이 가능하다. 이렇게해도 전혀 api 스펙을 어기는 것이 아닌 것이다.



- 가장 좋다고 생각하는 API : 어떠한 정보도 없는 누군가가 구구절절 다른 설명 없이 엔드포인트만 봐도 어떤 동작을 하는 API인지 바로 이해할 수 있을 정도로 명확한 API가 가장 좋은 API이다.
