- 다중화 
	- db서버가 2대가 있다면 1대가 고장난다 하더라도 나머지 1대가 동작하면 서비스의 정지를 막을 수 있다. 이것이 다중화이다. 
- 아키텍처
	- 시스템을 만들기 위한 물리 레벨의 조합. 
	- 어떤 기능을 가진 서버를 준비하고 어떠한 저장소나 네트워크 기기와 조합해서 시스템 전체를 만들 것인가. 
		- 즉 하드웨어와 미들웨어의 구성을 가리킨다. 
	- 아키텍처를 보면 그 시스템이 어떤 용도로 사용되고 무엇을 목적으로 하고 있는지를 어느 정도 추측할 수 있다. 


- 아키텍처의 최초 단계  : stand - alone
	- 데이터베이스가 동작하는 머신이 lan이나 인터넷 등의 네트워크에 접속하지 않고 독립되어 동작하는 구성이다. 
		- 물리적인 차원에서 가까운 곳에서 작업을 해야한다. 
	- 컴퓨터가 최초에 등장하던 시기에는 모든 컴퓨터가 stand-alone 형태였다. 이때까지는 복수의 컴퓨터가 협력하는 개념이 없었다. 
	- 장점 : 
		- 보안이 매우 높음. 
- Web 3 계층 
	- 클라이언트와 데이터베이스 계층 사이에 웹 서버 계층과 애플리케이션 계층이 추가 되어 있다. 
	- 웹서버는 클라에서 접속 요청을 받아서 그 처리를 뒷단의 어플리케이션 계층에 넘기고 그 결과를 클라이언트에 반환한다. 
		- 이때 이용되는 서버는 아파치나 iis가 유명하다. 


- 클러스터 
	- 동일한 기능의 컴포넌트를 병렬화하는 것을 클러스터링이라고 부른다. 클러스터는 사물이나 사람의 집합을 가리키는 말로, 포도 등의 '송이'라는 의미도 있다. 
	- 시스템 세계에서는 동일한 기능의 컴포넌트를 볷 개 준비해 한 개의 기능을 실현한다는 의미로 사용된다. 
	- 클러스터 구성으로 시스템의 가동률을 높이는 것을 여유도를 확보한다. 또는 다중화라고 지칭하기도 한다. 


## DB 서버의 다중화 - 클러스터링 

- db는 다중화가 어렵다.
	- 왜냐하면 db는 영속계층이기 때문이다. (영속계층이면 왜 어려운거지?)
	- 데이터베이스는 데이터를 장기간 보존하는 매체가 필요하다. 일반적으로는 이런 매체를 전용의 외부 저장소를 이용한다. 결국 db서버의 아키텍처는 무조건 저장소와 묶어서 생각을 해야한다. 
	- 이런 영속 계층의 사명이 부여되는 순간부터 다중화가 어려워진다. 왜냐하면 cpu나 메모리 같은 처리에 필요한 컴포넌트를 다중화하는 것은 간단한 일이지만, 데이터를 다중화하려고 한다면 매우 귀찮아지기 때문이다. 데이터는 항상 갱신되기 떄문에 다중화를 유지하는 중에 '데이터 정합성'도 중요하게 의식해야 한다. 


- 기본적인 다중화 
	- 서버 복수 - 저장소 1개 


- 리플리케이션 
	- 디비 서버와 저장소 세트를 복수로 준비하는 것 
	- 장점 : 이터베이스 서버와 저장소가 동시에 사용 불능일 때, 지진이나 태풍 등 으로 하드웨어가 설치된 시설이 파괴된 경우에 다른 1세트가 멀리 떨어진 지점에 놓여 있다면 서비 스를 계속하는 것이 가능하다는 점에서 매우 가용성이 높은 아키텍처라고 할 수 있다. 
	- 주의점 : 데이터의 정합성을 주의해야한다. 


- 성능을 추구하기 위한 다중화 - shared nothing 
	- 복수의 서버가 1대의 디스크를 사용하는 구성을 shared disk라고 부른다. 
		- Shared Disk 타입의 Active-Active 구성은 DB 서버를 늘려도 무한으로 처리율07이 향상되지 않 고 어딘가에서 한계점에 도달한다. 이것은 저장소가 공유 자원이라서 쉽게 늘리기 어렵고 DB 서 버 대수가 증가할수록 DB 서버 간의 정보공유를 위한 오버헤드가 크기 때문이다. 
	- shared nothing은 문자 그대로 아무것도 공유하지 않는 방식이다. 네트워크 이외의 자원을 모두 분리하는 방식이다. 
		- db서버와 저장소의 세트를 늘려서 저장소 자체가 병목이 되는 것을 방지한다. 때문에 세트에 비례하여 처리율이 증가한다. 
		- 이런 shared nothing이라는 방식을 샤당이라고 부른다. sharding. 
	- 단점도 있다. 
		- 각 디비 서버와 저장소가 매핑되어있기 때문에, 하나의 디비는 다른 저장소에 엑세스할 수가 없다는 것이다. 예를 들어서 고양시의 디비서버가 부천이나 광명시의 디비 서버에 엑세스할 수 없다. 때문에 전체 도시의 인구를 계산하려는 경우 각 세트로부터 인구를 모아 집계하는 정리 서버가 필요해진다. 




---

## 데이터의 정합성 


